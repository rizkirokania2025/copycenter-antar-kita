<!-- ===== Sidebar (Copy & replace existing sidebar) ===== -->
<aside id="appSidebar" class="sidebar">
  <div class="sidebar-top">
    <div class="logo-wrap">
      <div class="logo">CC</div>
      <div class="logo-text">
        <strong>Copycenter Antar Kita</strong>
        <small>Pencatatan & Kasir</small>
      </div>
    </div>

    <button id="sidebarToggle" class="sidebar-toggle" aria-label="Toggle sidebar">‚ò∞</button>
  </div>

  <nav class="side-links" role="navigation" aria-label="Main menu">
    <button data-page="dashboard" id="nav_dashboard" class="nav-btn active">üìä Dashboard <small>Ringkasan</small></button>
    <button data-page="sales" id="nav_sales" class="nav-btn">üí∞ Penjualan <small>Tambah & riwayat</small></button>
    <button data-page="products" id="nav_products" class="nav-btn">üì¶ Produk <small>Stok & harga</small></button>
    <button data-page="reports" id="nav_reports" class="nav-btn">üìë Laporan <small>Export / Backup</small></button>
    <button data-page="settings" id="nav_settings" class="nav-btn">‚öôÔ∏è Pengaturan <small>PIN & Auto-backup</small></button>
  </nav>

  <div class="sidebar-footer">
    <button id="btnOpenPOS" class="pos-btn">üßæ Buka Kasir (POS)</button>
  </div>
</aside>

<!-- ===== Sidebar Styles (add into your <style> or CSS file) ===== -->
<style>
/* ---------- layout / container ---------- */
.sidebar {
  width: 240px;
  min-width: 80px;
  max-width: 240px;
  display:flex;
  flex-direction:column;
  justify-content:space-between;
  padding:18px;
  gap:12px;
  background: linear-gradient(180deg,#0f6b63 0%,#0b524d 100%);
  color:#fff;
  border-top-right-radius:12px;
  border-bottom-right-radius:12px;
  box-shadow:3px 0 12px rgba(0,0,0,0.08);
  transition:all .28s ease;
  position:relative;
}

/* top row w/ toggle for small screens */
.sidebar-top{display:flex;align-items:center;justify-content:space-between;gap:8px}
.logo-wrap{display:flex;align-items:center;gap:12px}
.logo{width:56px;height:56px;border-radius:12px;background:#fff;color:#0f6b63;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:20px}
.logo-text strong{display:block;font-size:15px;color:#fff}
.logo-text small{display:block;color:#cdebe6;font-size:12px}

/* toggle for mobile collapse */
.sidebar-toggle{
  display:none;
  background:transparent;border:0;color:#fff;font-size:20px;cursor:pointer;padding:6px 8px;border-radius:8px;
}
.sidebar-toggle:hover{background:rgba(255,255,255,0.06)}

/* links */
.side-links{display:flex;flex-direction:column;gap:8px;margin-top:12px}
.side-links .nav-btn{
  background:transparent;border:0;color:#eaf5f4;text-align:left;padding:10px;border-radius:8px;cursor:pointer;font-size:15px;display:flex;flex-direction:column;gap:2px;transition:all .18s ease;
}
.side-links .nav-btn small{color:#b7e1d9;font-size:12px}
.side-links .nav-btn:hover{background:rgba(255,255,255,0.10);transform:translateX(6px)}
.side-links .nav-btn.active{background:rgba(255,255,255,0.18);font-weight:600;color:#fff;transform:none}

/* active indicator (left stripe) */
.side-links .nav-btn.active::before{
  content:"";position:absolute;width:4px;height:40%;left:0;border-top-right-radius:4px;border-bottom-right-radius:4px;background:#fff;transform:translateX(-12px);
}

/* footer */
.sidebar-footer{margin-top:8px}
#btnOpenPOS.pos-btn{
  width:100%;padding:10px;border-radius:8px;border:2px solid rgba(255,255,255,0.18);background:rgba(255,255,255,0.07);color:#fff;font-weight:700;cursor:pointer;
}
#btnOpenPOS.pos-btn:hover{background:#fff;color:#0f6b63;box-shadow:0 0 8px rgba(255,255,255,0.25)}

/* COLLAPSED (icon-only) */
.sidebar.collapsed{width:84px;padding-left:12px;padding-right:12px}
.sidebar.collapsed .logo-text{display:none}
.sidebar.collapsed .side-links .nav-btn{font-size:0;text-indent:-9999px;padding:12px;width:48px;height:48px;display:inline-flex;align-items:center;justify-content:center}
.sidebar.collapsed .side-links .nav-btn small{display:none}
.sidebar.collapsed .logo{width:48px;height:48px}

/* MOBILE drawer */
@media (max-width:920px){
  .sidebar{position:fixed;left:-320px;top:0;bottom:0;z-index:1400;overflow:auto;width:260px}
  .sidebar.open{left:0}
  .sidebar-toggle{display:inline-block}
}
/* ensure sidebar doesn't overflow in small screens in non-drawer mode */
@media (max-width:760px){
  .logo-text strong{font-size:14px}
}

/* small visual tweaks */
.side-links .nav-btn{position:relative}
</style>

<!-- ===== Sidebar JS (paste before </body>) ===== -->
<script>
(function(){
  const sidebar = document.getElementById('appSidebar');
  const toggle = document.getElementById('sidebarToggle');
  const btnPOS = document.getElementById('btnOpenPOS');
  const navBtns = Array.from(document.querySelectorAll('.side-links .nav-btn'));

  // helper: set active UI
  function setActive(page){
    navBtns.forEach(b=>{
      if(b.dataset.page === page) b.classList.add('active'); else b.classList.remove('active');
    });
  }

  // try to call app's page switcher (safe)
  function safeShowPage(name){
    try{
      if(typeof safeShowPage === 'function'){ safeShowPage(name); return; } // if app defines safeShowPage
    }catch(e){}
    try{
      if(window.showPage && typeof window.showPage === 'function'){ window.showPage(name); return; }
    }catch(e){}
    // fallback: log
    console.log('Sidebar: showPage("' + name + '") not found in app. Only UI toggled.');
  }

  // click handlers for nav buttons
  navBtns.forEach(btn=>{
    btn.addEventListener('click', ()=>{
      const page = btn.dataset.page || '';
      setActive(page);
      safeShowPage(page);
      // on small screens, auto-close drawer
      if(window.innerWidth <= 920 && sidebar.classList.contains('open')) sidebar.classList.remove('open');
    });
  });

  // sidebar collapse: double-click logo or click toggle
  toggle && toggle.addEventListener('click', ()=>{
    // mobile: open drawer
    if(window.innerWidth <= 920){
      sidebar.classList.toggle('open');
      return;
    }
    sidebar.classList.toggle('collapsed');
  });

  // allow double-click logo to collapse for desktop
  const logo = sidebar.querySelector('.logo');
  if(logo){
    logo.addEventListener('dblclick', ()=>{
      if(window.innerWidth > 920) sidebar.classList.toggle('collapsed');
    });
  }

  // POS button: attempt to call POS open function or show page 'pos'/'sales'
  btnPOS && btnPOS.addEventListener('click', ()=>{
    // try app-defined openPOS / openPos / showPage
    if(typeof window.openPOS === 'function'){ window.openPOS(); return; }
    if(typeof window.openPos === 'function'){ window.openPos(); return; }
    // fallback to showPage('sales') or showPage('pos')
    safeShowPage('sales');
    safeShowPage('pos');
    setActive('sales');
    // if mobile drawer open -> close
    if(window.innerWidth <= 920 && sidebar.classList.contains('open')) sidebar.classList.remove('open');
  });

  // close drawer when clicking outside (mobile)
  document.addEventListener('click', (e)=>{
    if(window.innerWidth <= 920 && sidebar.classList.contains('open')){
      if(!sidebar.contains(e.target) && !toggle.contains(e.target)){
        sidebar.classList.remove('open');
      }
    }
  });

  // keyboard: press "m" to toggle collapse for convenience
  document.addEventListener('keydown', (e)=>{
    if(e.key === 'm' && window.innerWidth > 920){
      sidebar.classList.toggle('collapsed');
    }
  });

  // initial: if viewport small -> collapsed (hide text) by default
  if(window.innerWidth <= 920) sidebar.classList.add('collapsed');

  // expose helper for debugging (optional)
  window._ccSidebar = { setActive, toggleCollapse: ()=>sidebar.classList.toggle('collapsed') };
})();
</script>
